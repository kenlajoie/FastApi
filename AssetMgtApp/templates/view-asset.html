{% include 'layout.html' %}

<style>
 .container {
    text-align: left;
 }

  .view-header {
    width: 100%;
    background-color:  rgb(255, 99, 71); /* Tomato color */
    color: black;
    text-align: center;
    padding-top: 4px;
    padding-bottom: 2px;
  }

  .view-footer {
    width: 100%;
    background-color:  rgb(255, 99, 71); /* Tomato color */
    color: black;
    text-align: center;
    padding-top: 4px;
    padding-bottom: 2px;
  }

  .list-content {
    background-color: #d9dee0;
    width: 100%;
    padding-top: 3px;
    padding-left: 3px;
  }

  .view-content {
    min-width: 375px; /* Minimum width */
    mac-width: 100%;  /* Width will scale to 100% of the parent element */
    background-color: #d9dee0;  /* light gray */
    padding: 2px 14px 2px;  /* top, left/right, bottom */
    display: flex;
    flex-direction: column;
    margin-top: 2px;
  }

  .view-detail content {
    min-width: 375px; /* Minimum width */
    width: 100%;      /* Width will scale to 100% of the parent element */
    border: 4px solid black; /*Border color and thickness */
    background-color: #d9dee0;  /* light gray */
    padding: 2px 14px 2px;  /* top, left/right, bottom */
    border-radius: 5px;
    display: flex;
    flex-direction: column;
    margin-top: 2px;
  }

  .addupdatedate-left {
    font-size: x-small;
    text-align: left;
    padding-top: 1px;
  }

  .addupdatedate-right {
    font-size: x-small;
    text-align: left;
    padding-top: 1px;
  }

  .dataheader-right {
    font-size: small;
    text-align: right;
    padding-right: 3px;
  }

  .dataheader-left {
    font-size: small;
    text-align: left;
    padding-right: 3px;
  }

  .datafield {
    border: 2px solid black; /* Border color and thickness */
    border-radius: 1px;
    margin: 3px;              /* Margin outside the border */
    padding-left: 2px;
    font-size: small
  }

  .datatextarea {
    border: 2px solid black; /* Border color and thickness */
    border-radius: 1px;
    margin: 3px;              /* Margin outside the border */
    padding-left: 2px;
    font-size: small
  }

 .databutton {
    padding: 0px 3px; /* Custom padding for thinner appearance */
    margin: 0px 10px; /* space around the button */
    font-size: x-small;
    background-color: #007bff;
    color: white;
    border: none; /* Removing default border for a cleaner look */
    border-radius: 3px; /* Optional: Rounded corners for a modern feel */
    cursor: pointer; /* Adds pointer on hover */
    transition: background-color 0.3s ease; /* Smooth background transition */
 }

 .databutton:hover {
    background-color: #0056b3; /* Darker blue on hover for feedback */
 }

 .databutton:focus {
    outline: none; /* Optional: removes focus outline for cleaner look */
    box-shadow: 0 0 3px 2px rgba(0, 123, 255, 0.5); /* Optional: subtle focus effect */
 }
</style>

<form id="viewAssetForm">
   <div class="form-group">
      <input type="text" class="form-control" name="redirect" value="{{redirect}}" hidden>
      <input type="text" class="form-control" name="mode" value="{{mode}}" hidden>
      <input type="text" class="form-control" name="todo_id" value="{{todo_id}}" hidden>
      <input type="text" class="form-control" name="assetId" value="{{asset.id}}" hidden>
   </div>


  <div class="view-header">
   <div class="row mx-0 pb-1 gx-0">
      <div class="col pagetitle d-flex justify-content-start">Asset</div>
   </div> <!--row-->
  </div> <!-- view-header -->

  <div class="view-content">
        <div class="row pt-2">
          <div class="col dataheader-left">Major</div>
          <div class="col dataheader-left">Minor</div>
          <div class="col dataheader-left">Type</div>
        </div>

        <div class="row">
          <div class="col datafield">{{asset.majorArea}}</div>
          <div class="col datafield">{{asset.minorArea}}</div>
          <div class="col datafield">{{asset.assetType}}</div>
        </div>

        <div class="row">
          <div class="col col-2 text-end dataheader-right">Asset:</div>
          <div class="col datafield">{{asset.description}}</div>
        </div>

        <div class="row">
          <div class="col-2 dataheader-right">Model:</div>
          <div class="col-3 datafield">{{asset.model}}</div>
          <div class="col-2 dataheader-right">State:</div>
          <div class="col-3 datafield">{{asset.assetState}}</div>
        </div>

        <div class="row">
          <div class="col-2 dataheader-right">Satillite:</div>
          <div class="col-3 datafield">{{asset.satellite}}</div>
          <div class="col-2 dataheader-right">Station:</div>
          <div class="col-3 datafield">{{asset.station}}</div>
        </div>

        <div class="row">
          <div class="col-2 dataheader-right">Lat:</div>
          <div class="col-3 datafield">{{asset.gpsLat}}</div>
          {% if asset.gpsLat and asset.gpsLng %}
          <div>
              <button class="databutton" type="button"
                 onclick="window.location.href='/assets/locate-asset-page/{{asset.id}}'">Locate</button>
          </div>
          {% endif %}
        </div>

        <div class="row">
          <div class="col-2 dataheader-right">Lng:</div>
          <div class="col-3 datafield">{{asset.gpsLng}}</div>
        </div>

        <div class="row">
          <div class="col-2 dataheader-right">Distance:</div>
          <div class="col-3 datafield">{{asset.distance}}</div>
        </div>

        <div class="row">
          <div class="col dataheader-left"><p id="location"></p></div>
        </div>

        <div class="row pb-2">
             <div class="col addupdatedate-left">
               <b>Created: </b>{{asset.createdDate}}<b> By: </b>{{asset.createdBy}}
            </div>
             <div class="col addupdatedate-right">
               <b>Updated: </b>{{asset.updatedDate}}<b> By: </b>{{asset.updatedBy}}
            </div>
         </div>

      <!-- asset navigation buttons -->
       <div class="row mx-0 pb-1 gx-0">
          <div class="col d-flex justify-content-end">
            {% if currentUser.userRole == 'ADMIN' %}
              <button class="databutton" id="delete" type="submit">Delete</button>
            {% endif %}
               <button class="databutton" type="button"
                    onclick="window.location.href='/assets/edit-asset-page/{{asset.id}}'">Edit</button>
              <button class="databutton" id="back" type="button"
                    onclick="window.location.href='/assets/asset-page'">Back</button>
              <button class="databutton" id="print" type="button"
                    onclick="printAsset()">Print</button>
          </div>
       </div> <!--row-->
  </div> <!-- view-content -->


  <div class="view-footer">
   <div class="row mx-0 pb-1 gx-0">
      <div class="col d-flex justify-content-start">
          Asset Todos
      </div>
   </div> <!--row-->
  </div> <!-- view-footer -->

  <!-- Scrollable todo content goes here -->
  <div class="view-content">
    {% if todo_list|length == 0 %}
       <div class="row mx-0 pb-1 gx-0">
         <div class="col d-flex justify-content-center">
             Asset has no Todos
         </div>
       </div> <!--row-->
   {% endif %}
  </div>

  <div class="view-content">
      <div id="container-list" class="container-list"></div>
  </div> <!--filter-content-->
</div> <!-- assetTicket -->

<div class="view-footer">
   <div class="row mx-0 pb-1 gx-0">
      <div class="col d-flex justify-content-end">
          <button class="databutton" id="addTodo" type="button"
             onclick="window.location.href='/todos/add-todo-asset-page/{{asset.id}}'">Add Asset Todo</button>
      </div>
   </div> <!--row-->
  </div> <!--filter-footer-->

</form>

<script>
function printAsset() {

      var printContent = document.getElementById('assetTicket').innerHTML;
      var originalContent = document.body.innerHTML;
      document.body.innerHTML = printContent;  // Replace the content with the print section

      window.print();  // Trigger the print dialog

      document.body.innerHTML = originalContent;  // Restore the original content
 }

//----------------------------------------------------------------------------
// create the todo list
const containerList = document.getElementById("container-list");
const addContainerButton = document.getElementById("add-container");
// Array to store the dynamic containers' data
let containersData = [];

{% for todo in todo_list %}
    newContainer = {
     id: {{todo.id}}
   };

   containersData.push(newContainer); // Add new container to the data array

  // Create a new container element and append it directly
  newContainerElement = document.createElement("div");
  newContainerElement.classList.add("container-item");

  newContainerElement.innerHTML = `
    <div class="row">
      <div class="col dataheader">AssignedTo</div>
      <div class="col dataheader">Priority</div>
      <div class="col dataheader">Status</div>
    </div>
    <div class="row">
      <div class="col datafield">{{todo.assignedTo}}</div>
      <div class="col datafield">{{todo.priority}}</div>
      <div class="col datafield">{{todo.todoStatus}}</div>
    </div>

    <div class="row">
      <div class="col col-2 text-end dataheader-right">Task:</div>
      <div class="col datafield">{{todo.task}}</div>
    </div>

    <div class="row">
      <div class="col col-2 text-end dataheader-right">Note:</div>
      <div class="col datafield">{{todo.note}}</div>
    </div>

    <div class="row">
      <div class="col-12 d-flex justify-content-end">
        <button class="databutton"
                onclick="window.location.href='/todos/view-todo-asset-page/{{todo.id}}'"
                type="button">View</button>
        <button class="databutton"
                onclick="window.location.href='/todos/edit-todo-asset-page/{{todo.id}}'"
                type="button">Edit</button>
        <button class="databutton"
                onclick="window.location.href='/todos/add-todo-asset-page/{{asset.id}}'"
                type="button" >Add</button>
    </div> <!--row--->

    <div style="border-top: 4px solid black; width: 98%; margin-top: 7px;"></div>

  `;

   // Append the new container element to the container list
   containerList.appendChild(newContainerElement);

{% endfor %}

</script>

